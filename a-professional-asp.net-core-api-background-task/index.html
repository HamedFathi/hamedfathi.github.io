<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>A Professional ASP.NET Core API - Background Task - Hamed Fathi&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hamed Fathi&#039;s Blog"><meta name="msapplication-TileImage" content="/img/pic.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hamed Fathi&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="In ASP.NET Core, background tasks can be implemented as hosted services. A hosted service is a class with background task logic that implements the IHostedService interface. This topic provides three"><meta property="og:type" content="blog"><meta property="og:title" content="A Professional ASP.NET Core API - Background Task"><meta property="og:url" content="https://hamedfathi.github.io/a-professional-asp.net-core-api-background-task/"><meta property="og:site_name" content="Hamed Fathi&#039;s Blog"><meta property="og:description" content="In ASP.NET Core, background tasks can be implemented as hosted services. A hosted service is a class with background task logic that implements the IHostedService interface. This topic provides three"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://hamedfathi.github.io/img/og_image.png"><meta property="article:published_time" content="2020-09-15T00:00:00.000Z"><meta property="article:modified_time" content="2023-07-28T08:36:42.658Z"><meta property="article:author" content="Hamed Fathi"><meta property="article:tag" content="dotnet"><meta property="article:tag" content="aspnetcore"><meta property="article:tag" content="webapi"><meta property="article:tag" content="backgroundtask"><meta property="article:tag" content="hostedservices"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://hamedfathi.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hamedfathi.github.io/a-professional-asp.net-core-api-background-task/"},"headline":"A Professional ASP.NET Core API - Background Task","image":["https://hamedfathi.github.io/img/og_image.png"],"datePublished":"2020-09-15T00:00:00.000Z","dateModified":"2023-07-28T08:36:42.658Z","author":{"@type":"Person","name":"Hamed Fathi"},"publisher":{"@type":"Organization","name":"Hamed Fathi's Blog","logo":{"@type":"ImageObject"}},"description":"In ASP.NET Core, background tasks can be implemented as hosted services. A hosted service is a class with background task logic that implements the IHostedService interface. This topic provides three"}</script><link rel="canonical" href="https://hamedfathi.github.io/a-professional-asp.net-core-api-background-task/"><link rel="icon" href="/img/pic.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Hamed Fathi&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hamedfathi"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-15T00:00:00.000Z" title="9/15/2020, 12:00:00 AM">2020-09-15</time></span><span class="level-item"><a class="link-muted" href="/categories/aspnetcore-api/">aspnetcore-api</a></span></div></div><h1 class="title is-3 is-size-4-mobile">A Professional ASP.NET Core API - Background Task</h1><div class="content"><p>In <code>ASP.NET Core</code>, background tasks can be implemented as <code>hosted services</code>. A hosted service is a class with background task logic that implements the <code>IHostedService</code> interface. This topic provides three hosted service examples:</p>
<ul>
<li>Background task that runs on a timer.</li>
<li>Hosted service that activates a scoped service. The scoped service can use dependency injection (DI).</li>
<li>Queued background tasks that run sequentially.</li>
</ul>
<span id="more"></span>

<h2 id="IHostedService-interface"><a href="#IHostedService-interface" class="headerlink" title="IHostedService interface"></a>IHostedService interface</h2><p>The <code>IHostedService</code> interface defines two methods for objects that are managed by the host:</p>
<p><strong>StartAsync(CancellationToken)</strong>: <code>StartAsync</code> contains the logic to start the background task. <code>StartAsync</code> is called before:</p>
<ul>
<li>The app’s request processing pipeline is configured (Startup.Configure).</li>
<li>The server is started and <code>IApplicationLifetime.ApplicationStarted</code> is triggered.<br>The default behavior can be changed so that the hosted service’s <code>StartAsync</code> runs after the app’s pipeline has been configured and ApplicationStarted is called.</li>
</ul>
<p><strong>StopAsync(CancellationToken)</strong>: Triggered when the host is performing a graceful shutdown. <code>StopAsync</code> contains the logic to end the background task. Implement IDisposable and finalizers (destructors) to dispose of any unmanaged resources.</p>
<p>The cancellation token has a default five second timeout to indicate that the shutdown process should no longer be graceful. When cancellation is requested on the token:</p>
<ul>
<li>Any remaining background operations that the app is performing should be aborted.</li>
<li>Any methods called in <code>StopAsync</code> should return promptly.</li>
</ul>
<p>However, tasks aren’t abandoned after cancellation is requested—the caller awaits all tasks to complete.</p>
<p>If the app shuts down unexpectedly, <code>StopAsync</code> might not be called. Therefore, any methods called or operations conducted in <code>StopAsync</code> might not occur.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">using</span> Microsoft.Extensions.Hosting;<br><span class="hljs-keyword">using</span> System.Threading;<br><span class="hljs-keyword">using</span> System.Threading.Tasks;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SampleHostedService</span> : <span class="hljs-title">IHostedService</span><br>&#123;<br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">StartAsync</span>(<span class="hljs-params">CancellationToken cancellationToken</span>)</span><br>	&#123;<br>	&#125;<br>	<br>	<span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">StopAsync</span>(<span class="hljs-params">CancellationToken cancellationToken</span>)</span><br>	&#123;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="BackgroundService-base-class"><a href="#BackgroundService-base-class" class="headerlink" title="BackgroundService base class"></a>BackgroundService base class</h2><p><code>BackgroundService</code> is a base class for implementing a long running <code>IHostedService</code>.</p>
<p><code>ExecuteAsync(CancellationToken)</code> is called to run the background service. The implementation returns a Task that represents the entire lifetime of the background service. No further services are started until <code>ExecuteAsync</code> becomes asynchronous, such as by calling await. Avoid performing long, blocking initialization work in <code>ExecuteAsync</code>. The host blocks in StopAsync(CancellationToken) waiting for <code>ExecuteAsync</code> to complete.</p>
<p>The cancellation token is triggered when IHostedService.StopAsync is called. Your implementation of <code>ExecuteAsync</code> should finish promptly when the cancellation token is fired in order to gracefully shut down the service. Otherwise, the service ungracefully shuts down at the shutdown timeout. For more information, see the IHostedService interface section.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">using</span> Microsoft.Extensions.Hosting;<br><span class="hljs-keyword">using</span> System.Threading;<br><span class="hljs-keyword">using</span> System.Threading.Tasks;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SampleBackgroundService</span> : <span class="hljs-title">BackgroundService</span><br>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ExecuteAsync</span>(<span class="hljs-params">CancellationToken cancellationToken</span>)</span><br>    &#123;<br>       <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Background-task-that-runs-on-a-timer"><a href="#Background-task-that-runs-on-a-timer" class="headerlink" title="Background task that runs on a timer"></a>Background task that runs on a timer</h2><p>A timed background task makes use of the <code>System.Threading.Timer</code> class. The timer triggers the task’s <code>DoWork</code> method. The timer is disabled on <code>StopAsync</code> and disposed when the service container is disposed on <code>Dispose</code>:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">using</span> Microsoft.Extensions.Hosting;<br><span class="hljs-keyword">using</span> Microsoft.Extensions.Logging;<br><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Threading;<br><span class="hljs-keyword">using</span> System.Threading.Tasks;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">TaskBg.Controllers</span><br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TimedHostedService</span> : <span class="hljs-title">IHostedService</span>, <span class="hljs-title">IDisposable</span><br>    &#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> executionCount = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;TimedHostedService&gt; _logger;<br>        <span class="hljs-keyword">private</span> Timer _timer;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TimedHostedService</span>(<span class="hljs-params">ILogger&lt;TimedHostedService&gt; logger</span>)</span><br>        &#123;<br>            _logger = logger;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">StartAsync</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>        &#123;<br>            _logger.LogInformation(<span class="hljs-string">&quot;Timed Hosted Service running.&quot;</span>);<br><br>            _timer = <span class="hljs-keyword">new</span> Timer(DoWork, <span class="hljs-literal">null</span>, TimeSpan.Zero,<br>                TimeSpan.FromSeconds(<span class="hljs-number">5</span>));<br><br>            <span class="hljs-keyword">return</span> Task.CompletedTask;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoWork</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> state</span>)</span><br>        &#123;<br>            <span class="hljs-keyword">var</span> count = Interlocked.Increment(<span class="hljs-keyword">ref</span> executionCount);<br><br>            _logger.LogInformation(<br>                <span class="hljs-string">&quot;Timed Hosted Service is working. Count: &#123;Count&#125;&quot;</span>, count);<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">StopAsync</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>        &#123;<br>            _logger.LogInformation(<span class="hljs-string">&quot;Timed Hosted Service is stopping.&quot;</span>);<br><br>            _timer?.Change(Timeout.Infinite, <span class="hljs-number">0</span>);<br><br>            <span class="hljs-keyword">return</span> Task.CompletedTask;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Dispose</span>(<span class="hljs-params"></span>)</span><br>        &#123;<br>            _timer?.Dispose();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The <code>Timer</code> doesn’t wait for previous executions of <code>DoWork</code> to finish, so the approach shown might not be suitable for every scenario. <code>Interlocked.Increment</code> is used to increment the execution counter as <strong>an atomic operation</strong>, which ensures that multiple threads <strong>don’t</strong> update <code>executionCount</code> concurrently.</p>
<p>The service is registered in:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-comment">// Startup.ConfigureServices</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigureServices</span>(<span class="hljs-params">IServiceCollection services</span>)</span><br>&#123;<br>    services.AddControllers();<br>    <br>    <span class="hljs-comment">// HERE</span><br>    services.AddHostedService&lt;TimedHostedService&gt;();<br>&#125;<br><br><span class="hljs-comment">// OR</span><br><span class="hljs-comment">// Program.cs</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><br>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span><br>    &#123;<br>        CreateHostBuilder(args).Build().Run();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IHostBuilder <span class="hljs-title">CreateHostBuilder</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span> =&gt;<br>        Host.CreateDefaultBuilder(args)<br>            .ConfigureWebHostDefaults(webBuilder =&gt;<br>            &#123;<br>                webBuilder.UseStartup&lt;Startup&gt;();<br>            &#125;)<br>            .ConfigureServices(services =&gt;<br>            &#123;<br>                <span class="hljs-comment">// HERE</span><br>                services.AddHostedService&lt;VideosWatcher&gt;();<br>            &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Consuming-a-scoped-service-in-a-background-task"><a href="#Consuming-a-scoped-service-in-a-background-task" class="headerlink" title="Consuming a scoped service in a background task"></a>Consuming a scoped service in a background task</h2><p>To use <code>scoped services</code> within a <code>BackgroundService</code>, create a scope. No scope is created for a hosted service by default.</p>
<p>The scoped background task service contains the background task’s logic. In the following example:</p>
<p>The service is asynchronous. The <code>DoWork</code> method returns a <code>Task</code>. For demonstration purposes, a delay of ten seconds is awaited in the <code>DoWork</code> method.<br>An <code>ILogger</code> is injected into the service.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IScopedProcessingService</span><br>&#123;<br>    <span class="hljs-function">Task <span class="hljs-title">DoWork</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span>;<br>&#125;<br><br><span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ScopedProcessingService</span> : <span class="hljs-title">IScopedProcessingService</span><br>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> executionCount = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger _logger;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ScopedProcessingService</span>(<span class="hljs-params">ILogger&lt;ScopedProcessingService&gt; logger</span>)</span><br>    &#123;<br>        _logger = logger;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">DoWork</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>    &#123;<br>        <span class="hljs-keyword">while</span> (!stoppingToken.IsCancellationRequested)<br>        &#123;<br>            executionCount++;<br><br>            _logger.LogInformation(<br>                <span class="hljs-string">&quot;Scoped Processing Service is working. Count: &#123;Count&#125;&quot;</span>, executionCount);<br><br>            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">10000</span>, stoppingToken);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The hosted service creates a scope to resolve the scoped background task service to call its <code>DoWork</code> method. <code>DoWork</code> returns a <code>Task</code>, which is awaited in <code>ExecuteAsync</code>:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ConsumeScopedServiceHostedService</span> : <span class="hljs-title">BackgroundService</span><br>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;ConsumeScopedServiceHostedService&gt; _logger;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConsumeScopedServiceHostedService</span>(<span class="hljs-params">IServiceProvider services, </span></span><br><span class="hljs-params"><span class="hljs-function">        ILogger&lt;ConsumeScopedServiceHostedService&gt; logger</span>)</span><br>    &#123;<br>        Services = services;<br>        _logger = logger;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> IServiceProvider Services &#123; <span class="hljs-keyword">get</span>; &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ExecuteAsync</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>    &#123;<br>        _logger.LogInformation(<br>            <span class="hljs-string">&quot;Consume Scoped Service Hosted Service running.&quot;</span>);<br><br>        <span class="hljs-keyword">await</span> DoWork(stoppingToken);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">DoWork</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>    &#123;<br>        _logger.LogInformation(<br>            <span class="hljs-string">&quot;Consume Scoped Service Hosted Service is working.&quot;</span>);<br><br>        <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> scope = Services.CreateScope())<br>        &#123;<br>            <span class="hljs-keyword">var</span> scopedProcessingService = <br>                scope.ServiceProvider<br>                    .GetRequiredService&lt;IScopedProcessingService&gt;();<br><br>            <span class="hljs-keyword">await</span> scopedProcessingService.DoWork(stoppingToken);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">StopAsync</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>    &#123;<br>        _logger.LogInformation(<br>            <span class="hljs-string">&quot;Consume Scoped Service Hosted Service is stopping.&quot;</span>);<br><br>        <span class="hljs-keyword">await</span> <span class="hljs-keyword">base</span>.StopAsync(stoppingToken);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The services are registered in <code>IHostBuilder.ConfigureServices</code> (Program.cs). The hosted service is registered with the <code>AddHostedService</code> extension method:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-comment">// Program.IHostBuilder.ConfigureServices</span><br><span class="hljs-comment">// Or</span><br><span class="hljs-comment">// // Startup.ConfigureServices</span><br><br>services.AddHostedService&lt;ConsumeScopedServiceHostedService&gt;();<br>services.AddScoped&lt;IScopedProcessingService, ScopedProcessingService&gt;();<br></code></pre></td></tr></table></figure>

<h2 id="Queued-background-tasks"><a href="#Queued-background-tasks" class="headerlink" title="Queued background tasks"></a>Queued background tasks</h2><p>A background task queue is based on the .NET 4.x <code>QueueBackgroundWorkItem</code>:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IBackgroundTaskQueue</span><br>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">QueueBackgroundWorkItem</span>(<span class="hljs-params">Func&lt;CancellationToken, Task&gt; workItem</span>)</span>;<br><br>    Task&lt;Func&lt;CancellationToken, Task&gt;&gt; DequeueAsync(<br>        CancellationToken cancellationToken);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BackgroundTaskQueue</span> : <span class="hljs-title">IBackgroundTaskQueue</span><br>&#123;<br>    <span class="hljs-keyword">private</span> ConcurrentQueue&lt;Func&lt;CancellationToken, Task&gt;&gt; _workItems = <br>        <span class="hljs-keyword">new</span> ConcurrentQueue&lt;Func&lt;CancellationToken, Task&gt;&gt;();<br>    <span class="hljs-keyword">private</span> SemaphoreSlim _signal = <span class="hljs-keyword">new</span> SemaphoreSlim(<span class="hljs-number">0</span>);<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">QueueBackgroundWorkItem</span>(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">        Func&lt;CancellationToken, Task&gt; workItem</span>)</span><br>    &#123;<br>        <span class="hljs-keyword">if</span> (workItem == <span class="hljs-literal">null</span>)<br>        &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(workItem));<br>        &#125;<br><br>        _workItems.Enqueue(workItem);<br>        _signal.Release();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;Func&lt;CancellationToken, Task&gt;&gt; DequeueAsync(<br>        CancellationToken cancellationToken)<br>    &#123;<br>        <span class="hljs-keyword">await</span> _signal.WaitAsync(cancellationToken);<br>        _workItems.TryDequeue(<span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> workItem);<br><br>        <span class="hljs-keyword">return</span> workItem;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>In the following <code>QueueHostedService</code> example:</p>
<p>The <code>BackgroundProcessing</code> method returns a <code>Task</code>, which is awaited in <code>ExecuteAsync</code>.<br>Background tasks in the queue are dequeued and executed in <code>BackgroundProcessing</code>.<br>Work items are awaited before the service stops in <code>StopAsync</code>.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">QueuedHostedService</span> : <span class="hljs-title">BackgroundService</span><br>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;QueuedHostedService&gt; _logger;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">QueuedHostedService</span>(<span class="hljs-params">IBackgroundTaskQueue taskQueue, </span></span><br><span class="hljs-params"><span class="hljs-function">        ILogger&lt;QueuedHostedService&gt; logger</span>)</span><br>    &#123;<br>        TaskQueue = taskQueue;<br>        _logger = logger;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> IBackgroundTaskQueue TaskQueue &#123; <span class="hljs-keyword">get</span>; &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ExecuteAsync</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>    &#123;<br>        _logger.LogInformation(<br>            <span class="hljs-string">$&quot;Queued Hosted Service is running.<span class="hljs-subst">&#123;Environment.NewLine&#125;</span>&quot;</span> +<br>            <span class="hljs-string">$&quot;<span class="hljs-subst">&#123;Environment.NewLine&#125;</span>Tap W to add a work item to the &quot;</span> +<br>            <span class="hljs-string">$&quot;background queue.<span class="hljs-subst">&#123;Environment.NewLine&#125;</span>&quot;</span>);<br><br>        <span class="hljs-keyword">await</span> BackgroundProcessing(stoppingToken);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">BackgroundProcessing</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>    &#123;<br>        <span class="hljs-keyword">while</span> (!stoppingToken.IsCancellationRequested)<br>        &#123;<br>            <span class="hljs-keyword">var</span> workItem = <br>                <span class="hljs-keyword">await</span> TaskQueue.DequeueAsync(stoppingToken);<br><br>            <span class="hljs-keyword">try</span><br>            &#123;<br>                <span class="hljs-keyword">await</span> workItem(stoppingToken);<br>            &#125;<br>            catch (Exception ex)<br>            &#123;<br>                _logger.LogError(ex, <br>                    <span class="hljs-string">&quot;Error occurred executing &#123;WorkItem&#125;.&quot;</span>, <span class="hljs-keyword">nameof</span>(workItem));<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">StopAsync</span>(<span class="hljs-params">CancellationToken stoppingToken</span>)</span><br>    &#123;<br>        _logger.LogInformation(<span class="hljs-string">&quot;Queued Hosted Service is stopping.&quot;</span>);<br><br>        <span class="hljs-keyword">await</span> <span class="hljs-keyword">base</span>.StopAsync(stoppingToken);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>A <code>MonitorLoop</code> service handles enqueuing tasks for the hosted service whenever the <code>w</code> key is selected on an input device:</p>
<ul>
<li>The <code>IBackgroundTaskQueue</code> is injected into the <code>MonitorLoop</code> service.</li>
<li><code>IBackgroundTaskQueue.QueueBackgroundWorkItem</code> is called to enqueue a work item.</li>
<li>The work item simulates a long-running background task:<ul>
<li>Three 5-second delays are executed (<code>Task.Delay</code>).</li>
<li>A try-catch statement traps <code>OperationCanceledException</code> if the task is cancelled.</li>
</ul>
</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MonitorLoop</span><br>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IBackgroundTaskQueue _taskQueue;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger _logger;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> CancellationToken _cancellationToken;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MonitorLoop</span>(<span class="hljs-params">IBackgroundTaskQueue taskQueue, </span></span><br><span class="hljs-params"><span class="hljs-function">        ILogger&lt;MonitorLoop&gt; logger, </span></span><br><span class="hljs-params"><span class="hljs-function">        IHostApplicationLifetime applicationLifetime</span>)</span><br>    &#123;<br>        _taskQueue = taskQueue;<br>        _logger = logger;<br>        _cancellationToken = applicationLifetime.ApplicationStopping;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">StartMonitorLoop</span>(<span class="hljs-params"></span>)</span><br>    &#123;<br>        _logger.LogInformation(<span class="hljs-string">&quot;Monitor Loop is starting.&quot;</span>);<br><br>        <span class="hljs-comment">// Run a console user input loop in a background thread</span><br>        Task.Run(() =&gt; Monitor());<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Monitor</span>(<span class="hljs-params"></span>)</span><br>    &#123;<br>        <span class="hljs-keyword">while</span> (!_cancellationToken.IsCancellationRequested)<br>        &#123;<br>            <span class="hljs-keyword">var</span> keyStroke = Console.ReadKey();<br><br>            <span class="hljs-keyword">if</span> (keyStroke.Key == ConsoleKey.W)<br>            &#123;<br>                <span class="hljs-comment">// Enqueue a background work item</span><br>                _taskQueue.QueueBackgroundWorkItem(<span class="hljs-keyword">async</span> token =&gt;<br>                &#123;<br>                    <span class="hljs-comment">// Simulate three 5-second tasks to complete</span><br>                    <span class="hljs-comment">// for each enqueued work item</span><br><br>                    <span class="hljs-built_in">int</span> delayLoop = <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">var</span> guid = Guid.NewGuid().ToString();<br><br>                    _logger.LogInformation(<br>                        <span class="hljs-string">&quot;Queued Background Task &#123;Guid&#125; is starting.&quot;</span>, guid);<br><br>                    <span class="hljs-keyword">while</span> (!token.IsCancellationRequested &amp;&amp; delayLoop &lt; <span class="hljs-number">3</span>)<br>                    &#123;<br>                        <span class="hljs-keyword">try</span><br>                        &#123;<br>                            <span class="hljs-keyword">await</span> Task.Delay(TimeSpan.FromSeconds(<span class="hljs-number">5</span>), token);<br>                        &#125;<br>                        catch (OperationCanceledException)<br>                        &#123;<br>                            <span class="hljs-comment">// Prevent throwing if the Delay is cancelled</span><br>                        &#125;<br><br>                        delayLoop++;<br><br>                        _logger.LogInformation(<br>                            <span class="hljs-string">&quot;Queued Background Task &#123;Guid&#125; is running. &quot;</span> +<br>                            <span class="hljs-string">&quot;&#123;DelayLoop&#125;/3&quot;</span>, guid, delayLoop);<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (delayLoop == <span class="hljs-number">3</span>)<br>                    &#123;<br>                        _logger.LogInformation(<br>                            <span class="hljs-string">&quot;Queued Background Task &#123;Guid&#125; is complete.&quot;</span>, guid);<br>                    &#125;<br>                    <span class="hljs-keyword">else</span><br>                    &#123;<br>                        _logger.LogInformation(<br>                            <span class="hljs-string">&quot;Queued Background Task &#123;Guid&#125; was cancelled.&quot;</span>, guid);<br>                    &#125;<br>                &#125;);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The services are registered in <code>IHostBuilder.ConfigureServices</code> (Program.cs). The hosted service is registered with the <code>AddHostedService</code> extension method:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-comment">// Program.IHostBuilder.ConfigureServices</span><br><span class="hljs-comment">// Or</span><br><span class="hljs-comment">// // Startup.ConfigureServices</span><br><br>services.AddSingleton&lt;MonitorLoop&gt;();<br>services.AddHostedService&lt;QueuedHostedService&gt;();<br>services.AddSingleton&lt;IBackgroundTaskQueue, BackgroundTaskQueue&gt;();<br></code></pre></td></tr></table></figure>

<p><code>MonitorLoop</code> is started in <code>Program.Main</code>:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">var</span> monitorLoop = host.Services.GetRequiredService&lt;MonitorLoop&gt;();<br>monitorLoop.StartMonitorLoop();<br></code></pre></td></tr></table></figure>

<h2 id="Quartz-net-scheduler"><a href="#Quartz-net-scheduler" class="headerlink" title="Quartz.net scheduler"></a>Quartz.net scheduler</h2><p>You are able to write any background services with the above approach but there are another options to do your background jobs via a scheduler.</p>
<p><code>Quartz.net</code> is an open-source job scheduling system for .NET and you can integrate as following:</p>
<p>Install the below packages</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">Install-Package Quartz -Version 3.1.0<br>dotnet add package Quartz --version 3.1.0<br>&lt;PackageReference Include=<span class="hljs-string">&quot;Quartz&quot;</span> Version=<span class="hljs-string">&quot;3.1.0&quot;</span> /&gt;<br><br>Install-Package Quartz.AspNetCore -Version 3.1.0<br>dotnet add package Quartz.AspNetCore --version 3.1.0<br>&lt;PackageReference Include=<span class="hljs-string">&quot;Quartz.AspNetCore&quot;</span> Version=<span class="hljs-string">&quot;3.1.0&quot;</span> /&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-comment">// ExampleJob.cs</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ExampleJob</span> : <span class="hljs-title">IJob</span><br>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Execute</span>(<span class="hljs-params">IJobExecutionContext context</span>)</span><br>    &#123;<br>        <span class="hljs-keyword">await</span> Console.Out.WriteLineAsync(<span class="hljs-string">&quot;Greetings from HelloJob!&quot;</span>).ConfigureAwait(<span class="hljs-literal">false</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Startup.ConfigureServices</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigureServices</span>(<span class="hljs-params">IServiceCollection services</span>)</span><br>&#123;<br>    services.AddControllers();<br><br>    <span class="hljs-comment">// base configuration for DI</span><br>    services.AddQuartz(q =&gt;<br>    &#123;<br>        <span class="hljs-comment">// handy when part of cluster or you want to otherwise identify multiple schedulers</span><br>        q.SchedulerId = <span class="hljs-string">&quot;Scheduler-Core&quot;</span>;<br><br>        <span class="hljs-comment">// we take this from appsettings.json, just show it&#x27;s possible</span><br>        <span class="hljs-comment">// q.SchedulerName = &quot;Quartz ASP.NET Core Sample Scheduler&quot;;</span><br><br>        <span class="hljs-comment">// we could leave DI configuration intact and then jobs need to have public no-arg constructor</span><br>        <span class="hljs-comment">// the MS DI is expected to produce transient job instances </span><br>        q.UseMicrosoftDependencyInjectionJobFactory(options =&gt;<br>        &#123;<br>            <span class="hljs-comment">// if we don&#x27;t have the job in DI, allow fallback to configure via default constructor</span><br>            options.AllowDefaultConstructor = <span class="hljs-literal">true</span>;<br>        &#125;);<br><br>        <span class="hljs-comment">// or </span><br>        <span class="hljs-comment">// q.UseMicrosoftDependencyInjectionScopedJobFactory();</span><br><br>        <span class="hljs-comment">// these are the defaults</span><br>        q.UseSimpleTypeLoader();<br>        q.UseInMemoryStore();<br>        q.UseDefaultThreadPool(tp =&gt;<br>        &#123;<br>            tp.MaxConcurrency = <span class="hljs-number">10</span>;<br>        &#125;);<br><br>        <span class="hljs-comment">// configure jobs with code</span><br>        <span class="hljs-keyword">var</span> jobKey = <span class="hljs-keyword">new</span> JobKey(<span class="hljs-string">&quot;awesome job&quot;</span>, <span class="hljs-string">&quot;awesome group&quot;</span>);<br>        q.AddJob&lt;ExampleJob&gt;(j =&gt; j<br>            .StoreDurably()<br>            .WithIdentity(jobKey)<br>            .WithDescription(<span class="hljs-string">&quot;my awesome job&quot;</span>)<br>        );<br><br>        q.AddTrigger(t =&gt; t<br>            .WithIdentity(<span class="hljs-string">&quot;Simple Trigger&quot;</span>)<br>            .ForJob(jobKey)<br>            .StartNow()<br>            .WithSimpleSchedule(x =&gt; x.WithInterval(TimeSpan.FromSeconds(<span class="hljs-number">1</span>)).RepeatForever())<br>            .WithDescription(<span class="hljs-string">&quot;my awesome simple trigger&quot;</span>)<br>        );<br><br>    &#125;);<br><br>    services.AddQuartzServer(options =&gt;<br>    &#123;<br>        <span class="hljs-comment">// when shutting down we want jobs to complete gracefully</span><br>        options.WaitForJobsToComplete = <span class="hljs-literal">true</span>;<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Quartz-net-Admin-UI"><a href="#Quartz-net-Admin-UI" class="headerlink" title="Quartz.net Admin UI"></a>Quartz.net Admin UI</h2><p><strong>Quartzmin</strong></p>
<p>Site: <a target="_blank" rel="noopener" href="https://github.com/jlucansky/Quartzmin">https://github.com/jlucansky/Quartzmin</a></p>
<p><strong>CrystalQuartz</strong></p>
<p>Site: <a target="_blank" rel="noopener" href="https://github.com/guryanovev/CrystalQuartz">https://github.com/guryanovev/CrystalQuartz</a></p>
<h2 id="Quartz-alternative"><a href="#Quartz-alternative" class="headerlink" title="Quartz alternative"></a>Quartz alternative</h2><p><strong>FluentScheduler</strong></p>
<p>Automated job scheduler with fluent interface for the .NET platform.</p>
<p>Site: <a target="_blank" rel="noopener" href="https://github.com/fluentscheduler/FluentScheduler">https://github.com/fluentscheduler/FluentScheduler</a></p>
<h2 id="Reference-s"><a href="#Reference-s" class="headerlink" title="Reference(s)"></a>Reference(s)</h2><p>Most of the information in this article has gathered from various references.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/host/hosted-services">https://docs.microsoft.com/en-us/aspnet/core/fundamentals/host/hosted-services</a></li>
<li><a target="_blank" rel="noopener" href="https://andrewlock.net/creating-a-quartz-net-hosted-service-with-asp-net-core/">https://andrewlock.net/creating-a-quartz-net-hosted-service-with-asp-net-core/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.infoworld.com/article/3529418/how-to-schedule-jobs-using-quartznet-in-aspnet-core.html">https://www.infoworld.com/article/3529418/how-to-schedule-jobs-using-quartznet-in-aspnet-core.html</a></li>
<li><a target="_blank" rel="noopener" href="https://thinkrethink.net/2018/05/31/run-scheduled-background-tasks-in-asp-net-core/">https://thinkrethink.net/2018/05/31/run-scheduled-background-tasks-in-asp-net-core/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.stevejgordon.co.uk/asp-net-core-2-ihostedservice">https://www.stevejgordon.co.uk/asp-net-core-2-ihostedservice</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/@nickfane/introduction-to-worker-services-in-net-core-3-0-4bb3fc631225">https://medium.com/@nickfane/introduction-to-worker-services-in-net-core-3-0-4bb3fc631225</a></li>
<li><a target="_blank" rel="noopener" href="https://www.quartz-scheduler.net/">https://www.quartz-scheduler.net/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/quartznet/quartznet/tree/master/src/Quartz.Examples.AspNetCore">https://github.com/quartznet/quartznet/tree/master/src/Quartz.Examples.AspNetCore</a></li>
<li><a target="_blank" rel="noopener" href="https://girishgodage.in/blog/customize-hostedservices">https://girishgodage.in/blog/customize-hostedservices</a></li>
</ul>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/dotnet/">dotnet</a><a class="link-muted mr-2" rel="tag" href="/tags/aspnetcore/">aspnetcore</a><a class="link-muted mr-2" rel="tag" href="/tags/webapi/">webapi</a><a class="link-muted mr-2" rel="tag" href="/tags/backgroundtask/">backgroundtask</a><a class="link-muted mr-2" rel="tag" href="/tags/hostedservices/">hostedservices</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/a-professional-asp.net-core-api-global-exception/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">A Professional ASP.NET Core API - Global Exception Handling</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/a-professional-asp.net-core-api-external-apis/"><span class="level-item">A Professional ASP.NET Core API - External APIs</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/pic.png" alt="Hamed Fathi"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Hamed Fathi</p><p class="is-size-6 is-block">Senior Software Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Austria</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">30</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">86</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://twitter.com/Hamed__Fathi" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hamedfathi"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/hamedfathi"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/Hamed__Fathi"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="StackOverflow" href="https://stackoverflow.com/users/3166171/hamedfathi"><i class="fab fa-stack-overflow"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/hamedfathi88"><i class="fab fa-facebook"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/aspnetcore/"><span class="level-start"><span class="level-item">aspnetcore</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/aspnetcore-api/"><span class="level-start"><span class="level-item">aspnetcore-api</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/aurelia/"><span class="level-start"><span class="level-item">aurelia</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/dotnet/"><span class="level-start"><span class="level-item">dotnet</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/amqp/"><span class="tag">amqp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/api/"><span class="tag">api</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aspnetcore/"><span class="tag">aspnetcore</span><span class="tag">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aurelia2/"><span class="tag">aurelia2</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/awesome/"><span class="tag">awesome</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/backgroundtask/"><span class="tag">backgroundtask</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/binding/"><span class="tag">binding</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bogus/"><span class="tag">bogus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bootstrap5/"><span class="tag">bootstrap5</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cache/"><span class="tag">cache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/caching/"><span class="tag">caching</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chai/"><span class="tag">chai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cors/"><span class="tag">cors</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp9/"><span class="tag">csharp9</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css-in-js/"><span class="tag">css-in-js</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/default-interface-method/"><span class="tag">default-interface-method</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/di/"><span class="tag">di</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/distributed/"><span class="tag">distributed</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dotnet/"><span class="tag">dotnet</span><span class="tag">26</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dotnet5/"><span class="tag">dotnet5</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dryioc/"><span class="tag">dryioc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/e2e/"><span class="tag">e2e</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/easynetq/"><span class="tag">easynetq</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/emotionjs/"><span class="tag">emotionjs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/end-to-end/"><span class="tag">end-to-end</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/exception/"><span class="tag">exception</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/extension-method/"><span class="tag">extension-method</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fakedata/"><span class="tag">fakedata</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/feature/"><span class="tag">feature</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featureflag/"><span class="tag">featureflag</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featuremanagement/"><span class="tag">featuremanagement</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/file/"><span class="tag">file</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fluentvalidation/"><span class="tag">fluentvalidation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/guard/"><span class="tag">guard</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/header/"><span class="tag">header</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/health/"><span class="tag">health</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/healthcheck/"><span class="tag">healthcheck</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/healthy/"><span class="tag">healthy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hostedservices/"><span class="tag">hostedservices</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/inmemory/"><span class="tag">inmemory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ioc/"><span class="tag">ioc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jest/"><span class="tag">jest</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lerna/"><span class="tag">lerna</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/localization/"><span class="tag">localization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/log/"><span class="tag">log</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/masstransit/"><span class="tag">masstransit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/messagebroker/"><span class="tag">messagebroker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/middleware/"><span class="tag">middleware</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/miniprofiler/"><span class="tag">miniprofiler</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mixon/"><span class="tag">mixon</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mocha/"><span class="tag">mocha</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/model/"><span class="tag">model</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/modelbinding/"><span class="tag">modelbinding</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/monorepository/"><span class="tag">monorepository</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openapi/"><span class="tag">openapi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pagination/"><span class="tag">pagination</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/paging/"><span class="tag">paging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pipeline/"><span class="tag">pipeline</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/plugin/"><span class="tag">plugin</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/polly/"><span class="tag">polly</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/profiler/"><span class="tag">profiler</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/puppeteer/"><span class="tag">puppeteer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/queue/"><span class="tag">queue</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rabbitmq/"><span class="tag">rabbitmq</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ratelimit/"><span class="tag">ratelimit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/refit/"><span class="tag">refit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/request/"><span class="tag">request</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/resiliency/"><span class="tag">resiliency</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/response/"><span class="tag">response</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/roslyn/"><span class="tag">roslyn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rss/"><span class="tag">rss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sourcegenerator/"><span class="tag">sourcegenerator</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sqlserver/"><span class="tag">sqlserver</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swagger/"><span class="tag">swagger</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tailwindcss/"><span class="tag">tailwindcss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/test/"><span class="tag">test</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testdata/"><span class="tag">testdata</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unhealthy/"><span class="tag">unhealthy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/upload/"><span class="tag">upload</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/validation/"><span class="tag">validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/versioning/"><span class="tag">versioning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webapi/"><span class="tag">webapi</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webpack/"><span class="tag">webpack</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-28T00:00:00.000Z">2023-07-28</time></p><p class="title"><a href="/the-dotnet-world-mixin/">The .NET World - Mixin</a></p><p class="categories"><a href="/categories/dotnet/">dotnet</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-08T00:00:00.000Z">2020-12-08</time></p><p class="title"><a href="/the-dotnet-world-csharp-source-generator/">The .NET World - C# Source Generator</a></p><p class="categories"><a href="/categories/dotnet/">dotnet</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-09T00:00:00.000Z">2020-11-09</time></p><p class="title"><a href="/write-a-custom-plugin-with-aurelia-2-and-lerna/">Write a custom plugin with Aurelia 2 and Lerna</a></p><p class="categories"><a href="/categories/aurelia/">aurelia</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-10-23T00:00:00.000Z">2020-10-23</time></p><p class="title"><a href="/a-professional-asp.net-core-api-rabbitmq/">A Professional ASP.NET Core API - RabbitMQ</a></p><p class="categories"><a href="/categories/aspnetcore-api/">aspnetcore-api</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-10-22T00:00:00.000Z">2020-10-22</time></p><p class="title"><a href="/a-professional-asp.net-core-rss/">A Professional ASP.NET Core - RSS</a></p><p class="categories"><a href="/categories/aspnetcore/">aspnetcore</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">July 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Hamed Fathi&#039;s Blog</a><p class="is-size-7"><span>&copy; 2023 Hamed Fathi</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>