<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>A Professional ASP.NET Core API - Rate Limit - Hamed Fathi&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hamed Fathi&#039;s Blog"><meta name="msapplication-TileImage" content="/img/pic.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hamed Fathi&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="AspNetCoreRateLimit is an ASP.NET Core rate limiting solution designed to control the rate of requests that clients can make to a Web API or MVC app based on IP address or client ID. The AspNetCoreRat"><meta property="og:type" content="blog"><meta property="og:title" content="A Professional ASP.NET Core API - Rate Limit"><meta property="og:url" content="https://hamedfathi.github.io/a-professional-asp.net-core-api-rate-limit/"><meta property="og:site_name" content="Hamed Fathi&#039;s Blog"><meta property="og:description" content="AspNetCoreRateLimit is an ASP.NET Core rate limiting solution designed to control the rate of requests that clients can make to a Web API or MVC app based on IP address or client ID. The AspNetCoreRat"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://hamedfathi.github.io/img/og_image.png"><meta property="article:published_time" content="2020-09-20T00:00:00.000Z"><meta property="article:modified_time" content="2023-07-28T08:36:42.662Z"><meta property="article:author" content="Hamed Fathi"><meta property="article:tag" content="dotnet"><meta property="article:tag" content="aspnetcore"><meta property="article:tag" content="webapi"><meta property="article:tag" content="ratelimit"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://hamedfathi.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hamedfathi.github.io/a-professional-asp.net-core-api-rate-limit/"},"headline":"A Professional ASP.NET Core API - Rate Limit","image":["https://hamedfathi.github.io/img/og_image.png"],"datePublished":"2020-09-20T00:00:00.000Z","dateModified":"2023-07-28T08:36:42.662Z","author":{"@type":"Person","name":"Hamed Fathi"},"publisher":{"@type":"Organization","name":"Hamed Fathi's Blog","logo":{"@type":"ImageObject"}},"description":"AspNetCoreRateLimit is an ASP.NET Core rate limiting solution designed to control the rate of requests that clients can make to a Web API or MVC app based on IP address or client ID. The AspNetCoreRat"}</script><link rel="canonical" href="https://hamedfathi.github.io/a-professional-asp.net-core-api-rate-limit/"><link rel="icon" href="/img/pic.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Hamed Fathi&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hamedfathi"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-20T00:00:00.000Z" title="9/20/2020, 12:00:00 AM">2020-09-20</time></span><span class="level-item"><a class="link-muted" href="/categories/aspnetcore-api/">aspnetcore-api</a></span></div></div><h1 class="title is-3 is-size-4-mobile">A Professional ASP.NET Core API - Rate Limit</h1><div class="content"><p><code>AspNetCoreRateLimit</code> is an ASP.NET Core rate limiting solution designed to control the rate of requests that clients can make to a Web API or MVC app based on IP address or client ID. The <code>AspNetCoreRateLimit</code> package contains an <code>IpRateLimitMiddleware</code> and a <code>ClientRateLimitMiddleware</code>, with each middleware you can set multiple limits for different scenarios like allowing an IP or Client to make a maximum number of calls in a time interval like per second, 15 minutes, etc. You can define these limits to address all requests made to an API or you can scope the limits to each API URL or HTTP verb and path.</p>
<span id="more"></span>

<p>Install the below package</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Install-Package AspNetCoreRateLimit -Version 3.0.5<br>dotnet add package AspNetCoreRateLimit --version 3.0.5<br>&lt;PackageReference Include=<span class="hljs-string">&quot;AspNetCoreRateLimit&quot;</span> Version=<span class="hljs-string">&quot;3.0.5&quot;</span> /&gt;<br></code></pre></td></tr></table></figure>

<p>You can use two kinds of limitation:</p>
<ul>
<li>Rate limiting based on <code>client IP</code></li>
<li>Rate limiting based on <code>client ID</code></li>
</ul>
<p>We examine both methods together.</p>
<p>First, Add the following code:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-comment">// Startup.ConfigureServices</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigureServices</span>(<span class="hljs-params">IServiceCollection services</span>)</span><br>&#123;<br>    <span class="hljs-comment">// needed to load configuration from appsettings.json</span><br>    services.AddOptions();<br><br>    <span class="hljs-comment">// needed to store rate limit counters and ip rules</span><br>    services.AddMemoryCache();<br><br>    <span class="hljs-comment">//load general configuration from appsettings.json</span><br>    <span class="hljs-comment">// IP</span><br>    services.Configure&lt;IpRateLimitOptions&gt;(Configuration.GetSection(<span class="hljs-string">&quot;IpRateLimiting&quot;</span>));<br>    <span class="hljs-comment">// Client</span><br>    services.Configure&lt;ClientRateLimitOptions&gt;(Configuration.GetSection(<span class="hljs-string">&quot;ClientRateLimiting&quot;</span>));<br><br>    <span class="hljs-comment">// IP</span><br>    <span class="hljs-comment">//load ip rules from appsettings.json</span><br>    services.Configure&lt;IpRateLimitPolicies&gt;(Configuration.GetSection(<span class="hljs-string">&quot;IpRateLimitPolicies&quot;</span>));<br>    <span class="hljs-comment">// Client</span><br>    <span class="hljs-comment">//load client rules from appsettings.json</span><br>    services.Configure&lt;ClientRateLimitPolicies&gt;(Configuration.GetSection(<span class="hljs-string">&quot;ClientRateLimitPolicies&quot;</span>));<br><br>    <span class="hljs-comment">// inject counter and rules stores</span><br>    services.AddSingleton&lt;IIpPolicyStore, MemoryCacheIpPolicyStore&gt;();<br>    services.AddSingleton&lt;IRateLimitCounterStore, MemoryCacheRateLimitCounterStore&gt;();<br><br>    services.AddControllers();<br><br>    <span class="hljs-comment">// https://github.com/aspnet/Hosting/issues/793</span><br>    <span class="hljs-comment">// the IHttpContextAccessor service is not registered by default.</span><br>    <span class="hljs-comment">// the clientId/clientIp resolvers use it.</span><br>    services.AddSingleton&lt;IHttpContextAccessor, HttpContextAccessor&gt;();<br>    <br>    <span class="hljs-comment">// configuration (resolvers, counter key builders)</span><br>    services.AddSingleton&lt;IRateLimitConfiguration, RateLimitConfiguration&gt;();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Second, You should register the middleware before any other components as following:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-comment">// Startup.Configure</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span><br>&#123;<br>    <span class="hljs-comment">// IP</span><br>    app.UseIpRateLimiting();<br>    <span class="hljs-comment">// Client</span><br>    app.UseClientRateLimiting();<br>    <br>    <span class="hljs-keyword">if</span> (env.IsDevelopment())<br>    &#123;<br>        app.UseDeveloperExceptionPage();<br>    &#125;<br>    app.UseHttpsRedirection();<br>    app.UseRouting();<br><br>    app.UseAuthorization();<br>    app.UseEndpoints(endpoints =&gt;<br>    &#123;<br>        endpoints.MapControllers();<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>If you load-balance your app, you’ll need to use <code>IDistributedCache</code> with <code>Redis</code> or <code>SQLServer</code> so that all kestrel instances will have the same rate limit store. Instead of the in-memory stores you should inject the distributed stores like this:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-comment">// inject counter and rules distributed cache stores</span><br><br><span class="hljs-comment">// IP</span><br>services.AddSingleton&lt;IIpPolicyStore, DistributedCacheIpPolicyStore&gt;();<br><span class="hljs-comment">// Client</span><br>services.AddSingleton&lt;IClientPolicyStore, DistributedCacheClientPolicyStore&gt;();<br><br>services.AddSingleton&lt;IRateLimitCounterStore,DistributedCacheRateLimitCounterStore&gt;();<br></code></pre></td></tr></table></figure>

<h2 id="IP-based"><a href="#IP-based" class="headerlink" title="IP-based:"></a>IP-based:</h2><p><strong>General rules appsettings.json:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;IpRateLimiting&quot;</span>: &#123;<br>  <span class="hljs-attr">&quot;EnableEndpointRateLimiting&quot;</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;StackBlockedRequests&quot;</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;RealIpHeader&quot;</span>: <span class="hljs-string">&quot;X-Real-IP&quot;</span>,<br>  <span class="hljs-attr">&quot;ClientIdHeader&quot;</span>: <span class="hljs-string">&quot;X-ClientId&quot;</span>,<br>  <span class="hljs-attr">&quot;HttpStatusCode&quot;</span>: <span class="hljs-number">429</span>,<br>  <span class="hljs-attr">&quot;IpWhitelist&quot;</span>: [ <span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-string">&quot;::1/10&quot;</span>, <span class="hljs-string">&quot;192.168.0.0/24&quot;</span> ],<br>  <span class="hljs-attr">&quot;EndpointWhitelist&quot;</span>: [ <span class="hljs-string">&quot;get:/api/license&quot;</span>, <span class="hljs-string">&quot;*:/api/status&quot;</span> ],<br>  <span class="hljs-attr">&quot;ClientWhitelist&quot;</span>: [ <span class="hljs-string">&quot;dev-id-1&quot;</span>, <span class="hljs-string">&quot;dev-id-2&quot;</span> ],<br>  <span class="hljs-attr">&quot;GeneralRules&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*:/api/*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1m&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">30</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*:/api/values&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;15m&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">5</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;get:/api/values&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1h&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">5</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1s&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">2</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;15m&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">100</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;12h&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">1000</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;7d&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">10000</span><br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p><em>EnableEndpointRateLimiting</em> </p>
<p>If it is set to <code>false</code> then the limits will apply globally and only rules that have as endpoint <code>*</code> will apply. For example if you set a limit of 5 calls per second, any HTTP call to any endpoint will count towards that limit.</p>
<p>If it is set to <code>true</code> then the limits will apply for each endpoint as in <code>&#123;HTTP_Verb&#125;:&#123;PATH&#125;</code>. For example if you set a limit of 5 calls per second for <code>*:/api/values</code> a client can call <code>get:/api/values</code> 5 times per second but also 5 times <code>put:/api/values</code>.</p>
<p><em>Endpoint</em></p>
<ul>
<li><code>*</code>: A placeholder to anything</li>
<li><code>&#123;HTTP_Verb&#125;:&#123;PATH&#125;</code>: Endpoint format like <code>get:/api/license</code></li>
</ul>
<p><em>Period</em></p>
<p>Period format is <code>&#123;INT&#125;&#123;PERIOD_TYPE&#125;</code>, you can use one of the following period types: <code>s, m, h, d</code>.</p>
<ul>
<li><code>s</code>: second</li>
<li><code>m</code>: minute</li>
<li><code>h</code>: hour</li>
<li><code>d</code>: day</li>
</ul>
<p><em>HttpStatusCode</em> </p>
<p>is set to <code>429</code>, which means the HTTP status code returned to the client after the limit is triggered.</p>
<p><em>ClientIdHeader</em></p>
<p>It is used to extract the client id, if a client id is present in this header and matches a value specified in <code>ClientWhitelist</code> then no rate limits are applied.</p>
<p><em>Limit</em></p>
<p>Number of requests allowed. Limit format is <code>&#123;LONG&#125;</code>.</p>
<p><strong>Specific IPs appsettings.json:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;IpRateLimitPolicies&quot;</span>: &#123;<br>  <span class="hljs-attr">&quot;IpRules&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;Ip&quot;</span>: <span class="hljs-string">&quot;84.247.85.224&quot;</span>,<br>      <span class="hljs-attr">&quot;Rules&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1s&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">10</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;15m&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">200</span><br>        &#125;<br>      ]<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Ip&quot;</span>: <span class="hljs-string">&quot;192.168.3.22/25&quot;</span>,<br>      <span class="hljs-attr">&quot;Rules&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1s&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">5</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;15m&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">150</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;12h&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">500</span><br>        &#125;<br>      ]<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Client-based"><a href="#Client-based" class="headerlink" title="Client-based"></a>Client-based</h2><p><strong>General rules appsettings.json:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;ClientRateLimiting&quot;</span>: &#123;<br>  <span class="hljs-attr">&quot;EnableEndpointRateLimiting&quot;</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;StackBlockedRequests&quot;</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">&quot;ClientIdHeader&quot;</span>: <span class="hljs-string">&quot;X-ClientId&quot;</span>,<br>  <span class="hljs-attr">&quot;HttpStatusCode&quot;</span>: <span class="hljs-number">429</span>,<br>  <span class="hljs-attr">&quot;EndpointWhitelist&quot;</span>: [ <span class="hljs-string">&quot;get:/api/license&quot;</span>, <span class="hljs-string">&quot;*:/api/status&quot;</span> ],<br>  <span class="hljs-attr">&quot;ClientWhitelist&quot;</span>: [ <span class="hljs-string">&quot;dev-id-1&quot;</span>, <span class="hljs-string">&quot;dev-id-2&quot;</span> ],<br>  <span class="hljs-attr">&quot;GeneralRules&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1s&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">2</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;15m&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">100</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;12h&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">1000</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>      <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;7d&quot;</span>,<br>      <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">10000</span><br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>Specific Clients appsettings.json:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;ClientRateLimitPolicies&quot;</span>: &#123;<br>  <span class="hljs-attr">&quot;ClientRules&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;ClientId&quot;</span>: <span class="hljs-string">&quot;client-id-1&quot;</span>,<br>      <span class="hljs-attr">&quot;Rules&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1s&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">10</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;15m&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">200</span><br>        &#125;<br>      ]<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;ClientId&quot;</span>: <span class="hljs-string">&quot;client-id-2&quot;</span>,<br>      <span class="hljs-attr">&quot;Rules&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;1s&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">5</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;15m&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">150</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;Endpoint&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>,<br>          <span class="hljs-attr">&quot;Period&quot;</span>: <span class="hljs-string">&quot;12h&quot;</span>,<br>          <span class="hljs-attr">&quot;Limit&quot;</span>: <span class="hljs-number">500</span><br>        &#125;<br>      ]<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Update-rate-limits-at-runtime"><a href="#Update-rate-limits-at-runtime" class="headerlink" title="Update rate limits at runtime"></a>Update rate limits at runtime</h2><p>At application startup the IP/client rate limit rules defined in <code>appsettings.json</code> are loaded in cache by either <code>MemoryCacheClientPolicyStore</code> or <code>DistributedCacheClientPolicyStore</code> depending on what type of cache provider you are using. You can access the IP/client policy store inside a controller and modify the rules like so:</p>
<p><strong>IP-based</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">IpRateLimitController</span> : <span class="hljs-title">Controller</span><br>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IpRateLimitOptions _options;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IIpPolicyStore _ipPolicyStore;<br><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">IpRateLimitController</span>(<span class="hljs-params">IOptions&lt;IpRateLimitOptions&gt; optionsAccessor, IIpPolicyStore ipPolicyStore</span>)</span><br>	&#123;<br>		_options = optionsAccessor.Value;<br>		_ipPolicyStore = ipPolicyStore;<br>	&#125;<br><br>	[<span class="hljs-meta">HttpGet</span>]<br>	<span class="hljs-function"><span class="hljs-keyword">public</span> IpRateLimitPolicies <span class="hljs-title">Get</span>(<span class="hljs-params"></span>)</span><br>	&#123;<br>		<span class="hljs-keyword">return</span> _ipPolicyStore.Get(_options.IpPolicyPrefix);<br>	&#125;<br><br>	[<span class="hljs-meta">HttpPost</span>]<br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Post</span>(<span class="hljs-params"></span>)</span><br>	&#123;<br>		<span class="hljs-keyword">var</span> pol = _ipPolicyStore.Get(_options.IpPolicyPrefix);<br><br>		pol.IpRules.Add(<span class="hljs-keyword">new</span> IpRateLimitPolicy<br>		&#123;<br>			Ip = <span class="hljs-string">&quot;8.8.4.4&quot;</span>,<br>			Rules = <span class="hljs-keyword">new</span> List&lt;RateLimitRule&gt;(<span class="hljs-keyword">new</span> RateLimitRule[] &#123;<br>				<span class="hljs-keyword">new</span> RateLimitRule &#123;<br>					Endpoint = <span class="hljs-string">&quot;*:/api/testupdate&quot;</span>,<br>					Limit = <span class="hljs-number">100</span>,<br>					Period = <span class="hljs-string">&quot;1d&quot;</span> &#125;<br>			&#125;)<br>		&#125;);<br><br>		_ipPolicyStore.Set(_options.IpPolicyPrefix, pol);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>Client-based</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ClientRateLimitController</span> : <span class="hljs-title">Controller</span><br>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ClientRateLimitOptions _options;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IClientPolicyStore _clientPolicyStore;<br><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ClientRateLimitController</span>(<span class="hljs-params">IOptions&lt;ClientRateLimitOptions&gt; optionsAccessor, IClientPolicyStore clientPolicyStore</span>)</span><br>	&#123;<br>		_options = optionsAccessor.Value;<br>		_clientPolicyStore = clientPolicyStore;<br>	&#125;<br><br>	[<span class="hljs-meta">HttpGet</span>]<br>	<span class="hljs-function"><span class="hljs-keyword">public</span> ClientRateLimitPolicy <span class="hljs-title">Get</span>(<span class="hljs-params"></span>)</span><br>	&#123;<br>		<span class="hljs-keyword">return</span> _clientPolicyStore.Get(<span class="hljs-string">$&quot;<span class="hljs-subst">&#123;_options.ClientPolicyPrefix&#125;</span>_cl-key-1&quot;</span>);<br>	&#125;<br><br>	[<span class="hljs-meta">HttpPost</span>]<br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Post</span>(<span class="hljs-params"></span>)</span><br>	&#123;<br>		<span class="hljs-keyword">var</span> id = <span class="hljs-string">$&quot;<span class="hljs-subst">&#123;_options.ClientPolicyPrefix&#125;</span>_cl-key-1&quot;</span>;<br>		<span class="hljs-keyword">var</span> clPolicy = _clientPolicyStore.Get(id);<br>		clPolicy.Rules.Add(<span class="hljs-keyword">new</span> RateLimitRule<br>		&#123;<br>			Endpoint = <span class="hljs-string">&quot;*/api/testpolicyupdate&quot;</span>,<br>			Period = <span class="hljs-string">&quot;1h&quot;</span>,<br>			Limit = <span class="hljs-number">100</span><br>		&#125;);<br>		_clientPolicyStore.Set(id, clPolicy);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Quota-exceeded-response"><a href="#Quota-exceeded-response" class="headerlink" title="Quota exceeded response"></a>Quota exceeded response</h2><p>You can customize the throttled response using the <code>QuotaExceededResponse</code> property of the <code>IpRateLimiting</code> or <code>ClientRateLimiting</code> configuration sections:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;IpRateLimiting&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;QuotaExceededResponse&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;Content&quot;</span>: <span class="hljs-string">&quot;&#123;&#123; \&quot;message\&quot;: \&quot;Whoa! Calm down, cowboy!\&quot;, \&quot;details\&quot;: \&quot;Quota exceeded. Maximum allowed: &#123;0&#125; per &#123;1&#125;. Please try again in &#123;2&#125; second(s).\&quot; &#125;&#125;&quot;</span>,<br>      <span class="hljs-attr">&quot;ContentType&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br>      <span class="hljs-attr">&quot;StatusCode&quot;</span>: <span class="hljs-number">429</span><br>    &#125;,<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>{0} - rule.Limit</li>
<li>{1} - rule.Period</li>
<li>{2} - retryAfter</li>
</ul>
<hr>
<h2 id="How-to-write-a-custom-IP-rate-limiter"><a href="#How-to-write-a-custom-IP-rate-limiter" class="headerlink" title="How to write a custom IP rate limiter?"></a>How to write a custom IP rate limiter?</h2><p>To begin with, we need a class that inherits from <code>ActionFilterAttribute</code>.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cs"><br><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Net;<br><span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc;<br><span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc.Filters;<br><span class="hljs-keyword">using</span> Microsoft.Extensions.Caching.Memory;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title">Attributes</span><br>&#123;<br>    [<span class="hljs-meta">AttributeUsage(AttributeTargets.Method)</span>]<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">RequestRateLimitAttribute</span> : <span class="hljs-title">ActionFilterAttribute</span><br>    &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Seconds &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> MemoryCache Cache &#123; <span class="hljs-keyword">get</span>; &#125; = <span class="hljs-keyword">new</span> MemoryCache(<span class="hljs-keyword">new</span> MemoryCacheOptions());<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnActionExecuting</span>(<span class="hljs-params">ActionExecutingContext context</span>)</span><br>        &#123;<br>            <span class="hljs-keyword">var</span> ipAddress = context.HttpContext.Request.HttpContext.Connection.RemoteIpAddress;<br>            <span class="hljs-keyword">var</span> memoryCacheKey = <span class="hljs-string">$&quot;<span class="hljs-subst">&#123;Name&#125;</span>-<span class="hljs-subst">&#123;ipAddress&#125;</span>&quot;</span>;<br><br>            <span class="hljs-keyword">if</span> (!Cache.TryGetValue(memoryCacheKey, <span class="hljs-keyword">out</span> <span class="hljs-built_in">bool</span> entry))<br>            &#123;<br>                <span class="hljs-keyword">var</span> cacheEntryOptions = <span class="hljs-keyword">new</span> MemoryCacheEntryOptions()<br>                    .SetAbsoluteExpiration(TimeSpan.FromSeconds(Seconds));<br>                Cache.Set(memoryCacheKey, <span class="hljs-literal">true</span>, cacheEntryOptions);<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>                context.Result = <span class="hljs-keyword">new</span> ContentResult<br>                &#123;<br>                    Content = <span class="hljs-string">$&quot;Requests are limited to 1, every <span class="hljs-subst">&#123;Seconds&#125;</span> seconds.&quot;</span>,<br>                &#125;;<br>                context.HttpContext.Response.StatusCode = (<span class="hljs-built_in">int</span>)HttpStatusCode.TooManyRequests;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>Name</code>: A name for uniqueness.</p>
<p><code>Seconds</code>: An integer to store the number of seconds.</p>
<p>We need to override the virtual OnActionExecuting method from our inherited class. Within this method we are doing the following:</p>
<ol>
<li><p>Obtaining the users ip address.</p>
</li>
<li><p>Storing the ip address in our memory cache, with a timeout based on the number of seconds we have assigned to our rate limiting action filter attribute.</p>
</li>
<li><p>Returning an error message and a relevant status code (HTTP 429), in the event that the user hits our rate limit for the Api.</p>
</li>
</ol>
<p>Now to apply our action filter attribute to our desired controller action. I’ve added a simple Api endpoint for this example, and applied the attribute to the method, stating that we want to rate limit to 1 request, every 5 seconds.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cs">[<span class="hljs-meta">ApiController</span>]<br>[<span class="hljs-meta">Route(<span class="hljs-meta-string">&quot;api&quot;</span>)</span>]<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ApiController</span> : <span class="hljs-title">ControllerBase</span><br>&#123;<br>    [<span class="hljs-meta">HttpGet</span>]<br>    <span class="hljs-comment">// HERE</span><br>    [<span class="hljs-meta">RequestRateLimit(Name = <span class="hljs-meta-string">&quot;Limit Request Number&quot;</span>, Seconds = 5)</span>]<br>    [<span class="hljs-meta">ProducesResponseType(StatusCodes.Status200OK)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">Get</span>(<span class="hljs-params"></span>)</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> Ok();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Reference-s"><a href="#Reference-s" class="headerlink" title="Reference(s)"></a>Reference(s)</h2><p>Most of the information in this article has gathered from various references.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/stefanprodan/AspNetCoreRateLimit">https://github.com/stefanprodan/AspNetCoreRateLimit</a></li>
<li><a target="_blank" rel="noopener" href="https://riptutorial.com/asp-net-core/example/18611/rate-limiting-based-on-client-ip">https://riptutorial.com/asp-net-core/example/18611/rate-limiting-based-on-client-ip</a></li>
<li><a target="_blank" rel="noopener" href="https://riptutorial.com/asp-net-core/example/18612/rate-limiting-based-on-client-id">https://riptutorial.com/asp-net-core/example/18612/rate-limiting-based-on-client-id</a></li>
<li><a target="_blank" rel="noopener" href="https://edi.wang/post/2019/6/16/ip-rate-limit-for-aspnet-core">https://edi.wang/post/2019/6/16/ip-rate-limit-for-aspnet-core</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sahgilbert/rate-limit-action-filter-attribute-aspnetcore">https://github.com/sahgilbert/rate-limit-action-filter-attribute-aspnetcore</a></li>
</ul>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/dotnet/">dotnet</a><a class="link-muted mr-2" rel="tag" href="/tags/aspnetcore/">aspnetcore</a><a class="link-muted mr-2" rel="tag" href="/tags/webapi/">webapi</a><a class="link-muted mr-2" rel="tag" href="/tags/ratelimit/">ratelimit</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/a-professional-asp.net-core-api-cors/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">A Professional ASP.NET Core API - CORS</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/a-professional-asp.net-core-api-swagger/"><span class="level-item">A Professional ASP.NET Core API - Swagger</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/pic.png" alt="Hamed Fathi"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Hamed Fathi</p><p class="is-size-6 is-block">Senior Software Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Austria</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">30</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">86</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://twitter.com/Hamed__Fathi" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hamedfathi"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/hamedfathi"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/Hamed__Fathi"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="StackOverflow" href="https://stackoverflow.com/users/3166171/hamedfathi"><i class="fab fa-stack-overflow"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/hamedfathi88"><i class="fab fa-facebook"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/aspnetcore/"><span class="level-start"><span class="level-item">aspnetcore</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/aspnetcore-api/"><span class="level-start"><span class="level-item">aspnetcore-api</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/aurelia/"><span class="level-start"><span class="level-item">aurelia</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/dotnet/"><span class="level-start"><span class="level-item">dotnet</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/amqp/"><span class="tag">amqp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/api/"><span class="tag">api</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aspnetcore/"><span class="tag">aspnetcore</span><span class="tag">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aurelia2/"><span class="tag">aurelia2</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/awesome/"><span class="tag">awesome</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/backgroundtask/"><span class="tag">backgroundtask</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/binding/"><span class="tag">binding</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bogus/"><span class="tag">bogus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bootstrap5/"><span class="tag">bootstrap5</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cache/"><span class="tag">cache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/caching/"><span class="tag">caching</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chai/"><span class="tag">chai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cors/"><span class="tag">cors</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp9/"><span class="tag">csharp9</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css-in-js/"><span class="tag">css-in-js</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/default-interface-method/"><span class="tag">default-interface-method</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/di/"><span class="tag">di</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/distributed/"><span class="tag">distributed</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dotnet/"><span class="tag">dotnet</span><span class="tag">26</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dotnet5/"><span class="tag">dotnet5</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dryioc/"><span class="tag">dryioc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/e2e/"><span class="tag">e2e</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/easynetq/"><span class="tag">easynetq</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/emotionjs/"><span class="tag">emotionjs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/end-to-end/"><span class="tag">end-to-end</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/exception/"><span class="tag">exception</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/extension-method/"><span class="tag">extension-method</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fakedata/"><span class="tag">fakedata</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/feature/"><span class="tag">feature</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featureflag/"><span class="tag">featureflag</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featuremanagement/"><span class="tag">featuremanagement</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/file/"><span class="tag">file</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fluentvalidation/"><span class="tag">fluentvalidation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/guard/"><span class="tag">guard</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/header/"><span class="tag">header</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/health/"><span class="tag">health</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/healthcheck/"><span class="tag">healthcheck</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/healthy/"><span class="tag">healthy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hostedservices/"><span class="tag">hostedservices</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/inmemory/"><span class="tag">inmemory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ioc/"><span class="tag">ioc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jest/"><span class="tag">jest</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lerna/"><span class="tag">lerna</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/localization/"><span class="tag">localization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/log/"><span class="tag">log</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/masstransit/"><span class="tag">masstransit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/messagebroker/"><span class="tag">messagebroker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/middleware/"><span class="tag">middleware</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/miniprofiler/"><span class="tag">miniprofiler</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mixon/"><span class="tag">mixon</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mocha/"><span class="tag">mocha</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/model/"><span class="tag">model</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/modelbinding/"><span class="tag">modelbinding</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/monorepository/"><span class="tag">monorepository</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openapi/"><span class="tag">openapi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pagination/"><span class="tag">pagination</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/paging/"><span class="tag">paging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pipeline/"><span class="tag">pipeline</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/plugin/"><span class="tag">plugin</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/polly/"><span class="tag">polly</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/profiler/"><span class="tag">profiler</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/puppeteer/"><span class="tag">puppeteer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/queue/"><span class="tag">queue</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rabbitmq/"><span class="tag">rabbitmq</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ratelimit/"><span class="tag">ratelimit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/refit/"><span class="tag">refit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/request/"><span class="tag">request</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/resiliency/"><span class="tag">resiliency</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/response/"><span class="tag">response</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/roslyn/"><span class="tag">roslyn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rss/"><span class="tag">rss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sourcegenerator/"><span class="tag">sourcegenerator</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sqlserver/"><span class="tag">sqlserver</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swagger/"><span class="tag">swagger</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tailwindcss/"><span class="tag">tailwindcss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/test/"><span class="tag">test</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testdata/"><span class="tag">testdata</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unhealthy/"><span class="tag">unhealthy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/upload/"><span class="tag">upload</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/validation/"><span class="tag">validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/versioning/"><span class="tag">versioning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webapi/"><span class="tag">webapi</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webpack/"><span class="tag">webpack</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-28T00:00:00.000Z">2023-07-28</time></p><p class="title"><a href="/the-dotnet-world-mixin/">The .NET World - Mixin</a></p><p class="categories"><a href="/categories/dotnet/">dotnet</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-08T00:00:00.000Z">2020-12-08</time></p><p class="title"><a href="/the-dotnet-world-csharp-source-generator/">The .NET World - C# Source Generator</a></p><p class="categories"><a href="/categories/dotnet/">dotnet</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-09T00:00:00.000Z">2020-11-09</time></p><p class="title"><a href="/write-a-custom-plugin-with-aurelia-2-and-lerna/">Write a custom plugin with Aurelia 2 and Lerna</a></p><p class="categories"><a href="/categories/aurelia/">aurelia</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-10-23T00:00:00.000Z">2020-10-23</time></p><p class="title"><a href="/a-professional-asp.net-core-api-rabbitmq/">A Professional ASP.NET Core API - RabbitMQ</a></p><p class="categories"><a href="/categories/aspnetcore-api/">aspnetcore-api</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-10-22T00:00:00.000Z">2020-10-22</time></p><p class="title"><a href="/a-professional-asp.net-core-rss/">A Professional ASP.NET Core - RSS</a></p><p class="categories"><a href="/categories/aspnetcore/">aspnetcore</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">July 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Hamed Fathi&#039;s Blog</a><p class="is-size-7"><span>&copy; 2023 Hamed Fathi</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>